(()=>{"use strict";var e={860:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.bookingsRuntime=void 0;const i=n(561);t.bookingsRuntime=(0,i.createHostModule)({checkoutBooking:({channel:e})=>function(...t){return e.invoke({namespace:"bookings",method:"checkoutBooking",args:t})},getCheckoutOptions:({channel:e})=>function(...t){return e.invoke({namespace:"bookings",method:"getCheckoutOptions",args:t})},getServiceAvailability:({channel:e})=>function(...t){return e.invoke({namespace:"bookings",method:"getServiceAvailability",args:t})}})},492:(e,t,n)=>{n(860)},153:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contextualizeSerivcePluginModuleV2=t.contextualizeEventDefinitionModuleV2=t.contextualizeRESTModuleV2=t.contextualizeHostModuleV2=t.ServicePluginDefinition=t.EventDefinition=void 0;const i=n(382);Object.defineProperty(t,"EventDefinition",{enumerable:!0,get:function(){return i.EventDefinition}}),Object.defineProperty(t,"ServicePluginDefinition",{enumerable:!0,get:function(){return i.ServicePluginDefinition}});const o=n(444);t.contextualizeHostModuleV2=function(e,t){return{...e,...Object.fromEntries(t.map((t=>[t,(...n)=>{const i=(0,o.resolveContext)();if(!i)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return i.initWixModules(e)[t].apply(void 0,n)}])))}},t.contextualizeRESTModuleV2=function(e,t){return(...n)=>{const i=(0,o.resolveContext)();return i?i.initWixModules(e,t).apply(void 0,n):e.apply(void 0,n)}},t.contextualizeEventDefinitionModuleV2=function(e){const t=(...t)=>{const n=(0,o.resolveContext)();return n?n.initWixModules(e).apply(void 0,t):()=>{}};return t.__type=e.__type,t.type=e.type,t.isDomainEvent=e.isDomainEvent,t.transformations=e.transformations,t},t.contextualizeSerivcePluginModuleV2=function(e){const t=(...t)=>{const n=(0,o.resolveContext)();return n?n.initWixModules(e).apply(void 0,t):()=>{}};return t.__type=e.__type,t.componentType=e.componentType,t.methods=e.methods,t}},444:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.runWithoutContext=t.contextualizeSerivcePluginModule=t.contextualizeEventDefinitionModule=t.contextualizeRESTModule=t.contextualizeHostModule=t.resolveContext=void 0;const r=n(884);function a(){const e="undefined"!=typeof $wixContext&&$wixContext.initWixModules?$wixContext.initWixModules:void 0!==globalThis.__wix_context__&&globalThis.__wix_context__.initWixModules?globalThis.__wix_context__.initWixModules:void 0;if(e)return{initWixModules:(t,n)=>s((()=>e(t,n))),fetchWithAuth(){throw new Error("fetchWithAuth is not available in this context")},graphql(){throw new Error("graphql is not available in this context")}};const t="undefined"!=typeof $wixContext?$wixContext.client:void 0!==r.wixContext.client?r.wixContext.client:void 0!==globalThis.__wix_context__?globalThis.__wix_context__.client:void 0,n="undefined"!=typeof $wixContext?$wixContext.elevatedClient:void 0!==r.wixContext.elevatedClient?r.wixContext.elevatedClient:void 0!==globalThis.__wix_context__?globalThis.__wix_context__.elevatedClient:void 0;return t||n?{initWixModules(e,i){if(i){if(!n)throw new Error("An elevated client is required to use elevated modules. Make sure to initialize the Wix context with an elevated client before using elevated SDK modules");return s((()=>n.use(e)))}if(!t)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return s((()=>t.use(e)))},fetchWithAuth:(e,n)=>{if(!t)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return t.fetchWithAuth(e,n)},async graphql(e,n,i){if(!t)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return t.graphql(e,n,i)}}:void 0}function s(e){const t=globalThis.__wix_context__,n={client:r.wixContext.client,elevatedClient:r.wixContext.elevatedClient};let i;globalThis.__wix_context__=void 0,r.wixContext.client=void 0,r.wixContext.elevatedClient=void 0,"undefined"!=typeof $wixContext&&(i={client:$wixContext?.client,elevatedClient:$wixContext?.elevatedClient},delete $wixContext.client,delete $wixContext.elevatedClient);try{return e()}finally{globalThis.__wix_context__=t,r.wixContext.client=n.client,r.wixContext.elevatedClient=n.elevatedClient,"undefined"!=typeof $wixContext&&($wixContext.client=i.client,$wixContext.elevatedClient=i.elevatedClient)}}t.resolveContext=a,t.contextualizeHostModule=function(e,t){return(...n)=>{const i=a();if(!i)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return i.initWixModules(e)[t].apply(void 0,n)}},t.contextualizeRESTModule=function(e,t){return(...n)=>{const i=a();if(!i)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return i.initWixModules(e,!!n[t]?.suppressAuth).apply(void 0,n)}},t.contextualizeEventDefinitionModule=function(e){return(...t)=>{const n=a();if(!n)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return n.initWixModules(e).apply(void 0,t)}},t.contextualizeSerivcePluginModule=function(e){return(...t)=>{const n=a();if(!n)throw new Error("Wix context is not available. Make sure to initialize the Wix context before using SDK modules");return n.initWixModules(e).apply(void 0,t)}},o(n(153),t),t.runWithoutContext=s},561:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createHostModule=void 0;const i=n(153);t.createHostModule=function(e){return(0,i.contextualizeHostModuleV2)({__type:"host",create:t=>Object.entries(e).reduce(((e,[n,i])=>({...e,[n]:i(t)})),{})},Object.keys(e))}},884:(e,t,n)=>{n.r(t),n.d(t,{wixContext:()=>i});var i={}},382:(e,t,n)=>{function i(e,t=!1,n=e=>e){return()=>({__type:"event-definition",type:e,isDomainEvent:t,transformations:n})}function o(e,t){return{__type:"service-plugin-definition",componentType:e,methods:t}}n.r(t),n.d(t,{EventDefinition:()=>i,SERVICE_PLUGIN_ERROR_TYPE:()=>r,ServicePluginDefinition:()=>o});var r="wix_spi_error"}},t={};function n(i){var o=t[i];if(void 0!==o)return o.exports;var r=t[i]={exports:{}};return e[i].call(r.exports,r,r.exports,n),r.exports}n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i=n(884),o=n(382);const r=e=>{switch(e){case"get":case"GET":return"GET";case"post":case"POST":return"POST";case"put":case"PUT":return"PUT";case"delete":case"DELETE":return"DELETE";case"patch":case"PATCH":return"PATCH";case"head":case"HEAD":return"HEAD";case"options":case"OPTIONS":return"OPTIONS";default:throw new Error(`Unknown method: ${e}`)}},a="www.wixapis.com";class s extends Error{message;response;constructor(e,t){super(e),this.message=e,this.response=t}async details(){const e=await this.response.json();return l(this.response.status,e?.message,e?.details,{requestId:this.response.headers.get("X-Wix-Request-Id"),details:e})}}const l=(e,t,n,i)=>({details:{...!n?.validationError&&{applicationError:{description:t,code:e,data:i}},...n},message:t}),c="x-wix-bi-gateway";function d(e){const t=globalThis.__wix_context__,n={client:i.wixContext.client,elevatedClient:i.wixContext.elevatedClient};let o;globalThis.__wix_context__=void 0,i.wixContext.client=void 0,i.wixContext.elevatedClient=void 0,"undefined"!=typeof $wixContext&&(o={client:$wixContext?.client,elevatedClient:$wixContext?.elevatedClient},delete $wixContext.client,delete $wixContext.elevatedClient);try{return e()}finally{globalThis.__wix_context__=t,i.wixContext.client=n.client,i.wixContext.elevatedClient=n.elevatedClient,"undefined"!=typeof $wixContext&&($wixContext.client=o.client,$wixContext.elevatedClient=o.elevatedClient)}}const u=(e,t,n,i)=>({response:{data:{details:{...!n?.validationError&&{applicationError:{description:t,code:e,data:i}},...n},message:t},status:e}});function p(){return{emit(e,...t){for(let n=0,i=this.events[e]||[],o=i.length;n<o;n++)i[n](...t)},events:{},on(e,t){return(this.events[e]||=[]).push(t),()=>{this.events[e]=this.events[e]?.filter((e=>t!==e))}}}}function h(e,t,n,i){let o;if(e.isDomainEvent){const e=n,{deletedEvent:t,actionEvent:r,createdEvent:a,updatedEvent:s,...l}=e,c={...i,...l};o=t?t?.deletedEntity?{entity:t?.deletedEntity,metadata:c}:{metadata:c}:r?{data:r.body,metadata:c}:{entity:a?.entity??s?.currentEntity,metadata:c}}else o={data:n,metadata:i};return t((e.transformations??(e=>e))(o))}function x(e){const t=e.headers||{Authorization:""},n=e.auth||{getAuthHeaders:e=>Promise.resolve({headers:{}})},l=n.getAuthHeaders.bind(void 0,e.host);n.getAuthHeaders=l;const{client:x,initModule:f}=function(e){const t=new Map,n=p();return{initModule:e=>i=>{const o=t.get(e.componentType.toLowerCase())??[];o.push({servicePluginDefinition:e,implementation:i}),t.set(e.componentType.toLowerCase(),o),n.emit("registered",e)},client:{...n,getRegisteredServicePlugins:()=>t,async parseJWT(t){if(!e.decodeJWT)throw new Error("decodeJWT is not supported by the authentication strategy");const{decoded:n,valid:i}=await e.decodeJWT(t,!0);if(!i)throw new Error("JWT is not valid");if("object"!=typeof n.data||null===n.data||!("metadata"in n.data)||"object"!=typeof n.data.metadata||null===n.data.metadata||!("appExtensionType"in n.data.metadata)||"string"!=typeof n.data.metadata.appExtensionType)throw new Error("Unexpected JWT data: expected object with metadata.appExtensionType string");return n.data},async process(e){const t=await this.parseJWT(e.body);return this.executeHandler(t,e.url)},async parseRequest(e){const t=await e.text();return this.parseJWT(t)},async processRequest(e){const t=e.url,n=await e.text(),i=await this.process({url:t,body:n});return Response.json(i)},async executeHandler(e,n){const i=e.metadata.appExtensionType.toLowerCase(),o=t.get(i)??[];if(0===o.length)throw new Error(`No service plugin implementations found for component type ${i}`);if(o.length>1)throw new Error(`Multiple service plugin implementations found for component type ${i}. This is currently not supported`);const{implementation:r,servicePluginDefinition:a}=o[0],s=a.methods.find((e=>n.endsWith(e.primaryHttpMappingPath)));if(!s)throw new Error("Unexpect request: request url did not match any method: "+n);const l=r[s.name];if(!l)throw new Error(`Got request for service plugin method ${s.name} but no implementation was provided. Available methods: ${Object.keys(r).join(", ")}`);return s.transformations.toREST(await l(s.transformations.fromREST(e)))}}}}(n),{client:v,initModule:w}=function(e){const t=new Map,n=p();return{initModule:e=>i=>{const o=t.get(e.type)??[];o.push({eventDefinition:e,handler:i}),t.set(e.type,o),n.emit("registered",e)},client:{...n,getRegisteredEvents:()=>t,async process(e,n={expectedEvents:[]}){const{eventType:i,identity:o,instanceId:r,payload:a}=await this.parseJWT(e),s=[...n.expectedEvents,...Array.from(t.keys()).map((e=>({type:e})))];if(s.length>0&&!s.some((({type:e})=>e===i)))throw new Error(`Unexpected event type: ${i}. Expected one of: ${s.map((e=>e.type)).join(", ")}`);const l=t.get(i)??[];return await Promise.all(l.map((({eventDefinition:e,handler:t})=>h(e,t,a,{instanceId:r,identity:o})))),{instanceId:r,eventType:i,payload:a,identity:o}},async processRequest(e,t){const n=await e.text();return this.process(n,t)},async parseJWT(t){if(!e.decodeJWT)throw new Error("decodeJWT is not supported by the authentication strategy");const{decoded:n,valid:i}=await e.decodeJWT(t);if(!i)throw new Error("JWT is not valid");if("string"!=typeof n.data)throw new Error("Unexpected type of JWT data: expected string, got "+typeof n.data);const o=JSON.parse(n.data),r=o.eventType,a=o.instanceId,s=o.identity?JSON.parse(o.identity):void 0;return{instanceId:a,eventType:r,payload:JSON.parse(o.data),identity:s}},async parseRequest(e){const t=await e.text();return this.parseJWT(t)},async executeHandlers(e){const n=Array.from(t.keys()).map((e=>({type:e})));if(n.length>0&&!n.some((({type:t})=>t===e.eventType)))throw new Error(`Unexpected event type: ${e.eventType}. Expected one of: ${n.map((e=>e.type)).join(", ")}`);const i=t.get(e.eventType)??[];await Promise.all(i.map((({eventDefinition:t,handler:n})=>h(t,n,e.payload,{instanceId:e.instanceId,identity:e.identity}))))},apps:{AppInstalled:(0,o.EventDefinition)("AppInstalled")(),AppRemoved:(0,o.EventDefinition)("AppRemoved")()}}}}(n),y=async(e,n)=>{const i=await l(),o=(e=>e?.method&&["post","put","patch"].includes(e.method.toLocaleLowerCase())&&e.body?{"Content-Type":"application/json"}:{})(n);return fetch(e,{...n,headers:{...o,...t,...i?.headers,...n?.headers}})},m=(t,n)=>{if("event-definition"===t.__type)return w(t);if("service-plugin-definition"===t.__type)return f(t);var i;if((e=>"host"===e.__type)(t)&&e.host)return function(e,t){return e.create(t)}(t,e.host);if("function"==typeof t){if("__type"in t&&t.__type===o.SERVICE_PLUGIN_ERROR_TYPE)return t;const s=e.host?.apiBaseUrl??a;return function(e,t,n,i,o){return d((()=>e({request:async e=>{const i=e({host:o?.HTTPHost||a});let r=i;"GET"===r.method&&r.fallback?.length&&r.params.toString().length>4e3&&(r=i.fallback[0]);let s=`https://${o?.HTTPHost??a}${r.url}`;r.params&&r.params.toString()&&(s+=`?${r.params.toString()}`);try{const e=function(e,t){return{[c]:(n={environment:"js-sdk","package-name":e.packageName??t?.PACKAGE_NAME,"method-fqn":e.methodFqn,entity:e.entityFqdn},Object.entries(n).filter((([e,t])=>Boolean(t))).map((([e,t])=>`${e}=${t}`)).join(","))};var n}(i,t),o=await n(s,{method:r.method,...r.data&&{body:JSON.stringify(r.data)},headers:{...e}});if(200!==o.status){let e=null;try{e=await o.json()}catch(e){}throw u(o.status,e?.message,e?.details,{requestId:o.headers.get("X-Wix-Request-Id"),details:e})}return{data:await o.json(),headers:o.headers,status:o.status,statusText:o.statusText}}catch(e){throw e.message?.includes("fetch is not defined")&&console.error("Node.js v18+ is required"),e}},fetchWithAuth:n,wixAPIFetch:i})))}(d((()=>(e=>{if(e.__isAmbassador)return!0;const t=e();return Boolean(t.__isAmbassador)})(t)))?(i=t,e=>async t=>{let n;const o=e=>{if(n=i(t)(e),void 0===n.url)throw new Error("Url was not successfully created for this request, please reach out to support channels for assistance.");const{method:o,url:a,params:s}=n;return{...n,method:r(o),url:a,data:n.data,params:s}};try{const t=await e.request(o);if(void 0===n)throw new Error("Request options were not created for this request, please reach out to support channels for assistance.");const i=Array.isArray(n.transformResponse)?n.transformResponse:[n.transformResponse];let r=t.data;return i.forEach((e=>{e&&(r=e(t.data,t.headers))})),r}catch(e){if("object"==typeof e&&null!==e&&"response"in e&&"object"==typeof e.response&&null!==e.response&&"data"in e.response)throw e.response.data;throw e}}):t,n??{},y,((e,t)=>{const n=new URL(e,`https://${s}`);return n.host=s,n.protocol="https",y(n.toString(),t)}),{HTTPHost:s})}return(e=>e&&"object"==typeof e&&!Array.isArray(e))(t)?Object.fromEntries(Object.entries(t).map((([e,n])=>[e,m(n,t.__metadata)]))):t};return{...e.modules?m(e.modules):{},auth:n,setHeaders:e=>{for(const n in e)t[n]=e[n]},use:m,enableContext(e,t={elevated:!1}){"global"===e?null!=globalThis.__wix_context__?t.elevated?globalThis.__wix_context__.elevatedClient=this:globalThis.__wix_context__.client=this:t.elevated?globalThis.__wix_context__={elevatedClient:this}:globalThis.__wix_context__={client:this}:t.elevated?i.wixContext.elevatedClient=this:i.wixContext.client=this},fetch:(t,n)=>{const i=e.host?.apiBaseUrl??a,o=new URL(t,`https://${i}`);return o.host=i,o.protocol="https",y(o.toString(),n)},fetchWithAuth:async(e,t)=>{if("string"==typeof e||e instanceof URL)return fetch(e,{...t,headers:{...t?.headers,...(await l()).headers}});for(const[t,n]of Object.entries((await l()).headers))e.headers.set(t,n);return fetch(e,t)},async graphql(t,n,i={apiVersion:"alpha"}){const o=e?.host?.apiBaseUrl??a,r=await y(`https://${o}/graphql/${i.apiVersion}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,variables:n})});if(200!==r.status)throw new s(`GraphQL request failed with status ${r.status}`,r);const{data:l,errors:c}=await r.json();return{data:l??{},errors:c}},webhooks:v,servicePlugins:x}}const f=e=>{let{clientSdk:t,applicationId:n}=e;return{invoke:async e=>{let{namespace:i,method:o,args:r}=e;return t.invoke({namespace:i,method:o,args:r,applicationId:n,accessToken:"accessToken"})},getAccessToken:()=>{throw new Error("Not implemented")},observeState:()=>({disconnect:()=>{}})}},v=(e=>{let{createHost:t}=e;return{__type:"host",create:e=>({}),host:t,auth:e=>{const t="undefined"!=typeof window?window.wixEmbedsAPI:void 0;e||(e=null==t||null==t.getAccessTokenFunction?void 0:t.getAccessTokenFunction());let n=!1;const{resolve:i,promise:o}=function(){let e=null,t=null;return{promise:new Promise(((n,i)=>{e=n,t=i})),resolve:e,reject:t}}();return{getAuthHeaders:async()=>{if(!e&&n&&(e=await o),!e)throw new Error("Failed to resolve auth token");return{headers:{Authorization:await e()}}},createInjector:()=>(n=!0,e=>{i(e)})}}}})({createHost:function(e){const t="undefined"!=typeof $wixContext&&$wixContext.clientSdk||(null==e?void 0:e.clientSdk)||window.clientSdk,{applicationId:n}=e||{};if(!n)throw new Error('"createHost" was called without a required field "applicationId"');if(!t)throw new Error("Wix Site SDK only works in a Wix site environment. Learn more: https://dev.wix.com/docs/sdk/host-modules/site/introduction");return{channel:f({clientSdk:t,applicationId:n}),close:()=>{}}}});var w=n(492);class y extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.container=document.createElement("div"),this.container.style.padding="10px",this.shadowRoot.appendChild(this.container),this.textElement=document.createElement("span"),this.container.appendChild(this.textElement),this.setColor(this.getAttribute("color")),this.setTextContent("init")}static get observedAttributes(){return["color","bookingsServiceId"]}async attributeChangedCallback(e,t,n){"color"===e&&t!==n?this.setColor(n):"bookingsServiceId"===e&&t!==n&&(console.log("Booking ID attribute changed"),this.setTextContent("Service ID: "+n))}accessTokenListener(e){const t=x({host:v.host({applicationId:"766caf23-967f-4b3f-9999-8ece1efdf29b"}),auth:v.auth(e),modules:{services:w.services}});console.log("createClient",t)}setColor(e){this.container.style.backgroundColor=e||"gray"}setTextContent(e){this.textElement.textContent=e||""}}customElements.define("ce-josh",y)})();